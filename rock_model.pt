import torch
import torch.nn as nn
from torchvision import models

# Number of classes in your rock dataset
num_classes = 5  # <-- change this to your actual classes

# Load pretrained MobileNetV3
model = models.mobilenet_v3_large()
state_dict = torch.load("mobilenet_v3_large.pth", map_location="cpu")
model.load_state_dict(state_dict)

# Replace classifier head
in_features = model.classifier[3].in_features
model.classifier[3] = nn.Linear(in_features, num_classes)

# Save ONLY state_dict (safe for Hugging Face Spaces)
torch.save(model.state_dict(), "rock_model_state.pt")

print("âœ… rock_model_state.pt has been created successfully")
