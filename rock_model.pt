import torch
import torch.nn as nn
from torchvision import models

# Number of rock formation classes (update this to match your dataset)
num_classes = 5   # <-- change this to your actual number of classes

# Load pretrained MobileNetV3 Large
model = models.mobilenet_v3_large()
state_dict = torch.load("mobilenet_v3_large.pth")
model.load_state_dict(state_dict)

# Replace the final classification layer with your custom classes
in_features = model.classifier[3].in_features
model.classifier[3] = nn.Linear(in_features, num_classes)

# Save the modified model
torch.save(model, "rock_model.pt")

print("rock_model.pt has been saved successfully!")
